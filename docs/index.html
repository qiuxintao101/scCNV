<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand -->
<html lang="en">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>What the Package Does (One Line, Title Case) â€¢ scCNV</title>
      <!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap -->
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
      <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc -->
      <link rel="stylesheet" href="bootstrap-toc.css">
      <script src="bootstrap-toc.js"></script><!-- Font Awesome icons -->
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
      <!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown -->
      <link href="pkgdown.css" rel="stylesheet">
      <script src="pkgdown.js"></script>
      <meta property="og:title" content="What the Package Does (One Line, Title Case)">
      <meta property="og:description" content="What the package does (one paragraph).">
      <!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
      <![endif]-->
   </head>
   <body data-spy="scroll" data-target="#toc">
      <div class="container template-home">
         <header>
            <div class="navbar navbar-default navbar-fixed-top" role="navigation">
               <div class="container">
                  <div class="navbar-header">
                     <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
                     <span class="sr-only">Toggle navigation</span>
                     <span class="icon-bar"></span>
                     <span class="icon-bar"></span>
                     <span class="icon-bar"></span>
                     </button>
                     <span class="navbar-brand">
                     <a class="navbar-link" href="index.html">scCNV</a>
                     </span>
                  </div>
                  <div id="navbar" class="navbar-collapse collapse">
                     <ul class="nav navbar-nav">
                        <li>
                           <a href="index.html">
                           <span class="fas fa fas fa-home fa-lg"></span>
                           </a>
                        </li>
                        <li>
                           <a href="reference/index.html">Reference</a>
                        </li>
                        <li>
                           <a href="https://github.com/qiuxintao101/scCNV">
                           <span class="fa fa-github"></span>
                           GitHub
                           </a>
                        </li>
                     </ul>
                     <ul class="nav navbar-nav navbar-right"></ul>
                  </div>
                  <!--/.nav-collapse -->
               </div>
               <!--/.container -->
            </div>
            <!--/.navbar -->
         </header>
         <div class="row">
            <div class="contents col-md-9">
               <div id="sccnv" class="section level1">
                  <div class="page-header">
                     <h1 class="hasAnchor">
                        <a href="#sccnv" class="anchor"></a>scCNV
                     </h1>
                  </div>
                  <!-- badges: start -->
                  <!-- badges: end -->
                  <p>scCNV is an R package for the analysis of signle cell copy  number variation analysis. scCNV takes as input genomic fragments and genomic sequence lengths, as well as a peaks and barcode file and various other supporting constants. scCNV first calculations the copy number for each genomic feature and cell, and uses this information to create a fold change matrix based on a GC matched background. scCNV then uses hiearchical or k-means clustering to produce a heatmap of the data. scCNV also provides options to repeat this process after aggregating similar cells into supercells. </p>
                  <div id="installation" class="section level2">
                     <h2 class="hasAnchor">
                        <a href="#installation" class="anchor"></a>Installation
                     </h2>
                     <p>You can install the released version of scCNV from Github with:</p>
                     <div class="sourceCode" id="cb1">
                        <pre class="r"><span class="kw pkg">devtools</span><span class="kw ns">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span>(<span class="st">"qiuxintao101/scCNV"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">scCNV</span>)</pre>
                     </div>
                  </div>
                  <div id="tiles" class="section level2">
                     <h2 class="hasAnchor">
                        <a href="#example" class="anchor"></a>Creating Genomic Tiles and Removing Unmappable Tiles
                     </h2>
                     <p>The following code is an example of how to produce genomic tiles:</p>
                     <div class="sourceCode" id="cb2">
                        <pre class="r">
<span class ="no">tiles <- tileGenome(seqlengths = gz, tilewidth = binsize, cut.last.tile.in.chrom = TRUE)
tiles <- removeUnmapped(tiles,unmapped_region)</span></pre>
                     </div>
                  </div>
                  <div id="gc_content" class="section level2">
                     <h2 class="hasAnchor">
                        <a href="#example" class="anchor"></a>Calculating GC Content for each tile
                     </h2>
                     <p>The following code converts genomic tiles to a dataframe and calculate the GC content of each:</p>
                     <div class="sourceCode" id="cb2">
                        <pre class="r"><span class ="no">df <- tileTodf(tiles)
df <- calcGC(df, tiles, GC_cutoff)</span></pre>
                     </div>
                  </div>
                  <div id="peaks" class="section level2">
                     <h2 class="hasAnchor">
                        <a href="#example" class="anchor"></a>Calculating Peak Overlap
                     </h2>
                     <p>The following line calculates the overlap of between the tiles and peaks. Tiles containing above a certain percentage of peaks are removed:</p>
                     <div class="sourceCode" id="cb2">
                        <pre class="r"><span class ="no">df <- calcOverlap(df, tiles, peaks, genome, peak_occ_cutoff)</span></pre>
                     </div>
                  </div>
                  <div id="count" class="section level2">
                     <h2 class="hasAnchor">
                        <a href="#example" class="anchor"></a>Produce a Count Matrix
                     </h2>
                     <p>The following line produces a count matrix of certain cells using a fragments.tsv file:</p>
                     <div class="sourceCode" id="cb2">
                        <pre class="r"><span class ="no">data <- getBinMatrix(cells, df, fragments)</span></pre>
                     </div>
                  </div>
                  <div id="coverage" class="section level2">
                     <h2 class="hasAnchor">
                        <a href="#example" class="anchor"></a>Calculate Coverage
                     </h2>
                     <p>The following line produces a coverage table using copy numbers and lengths of fragments:</p>
                     <div class="sourceCode" id="cb2">
                        <pre class="r"><span class ="no">coverage <- calcCoverage(data, df, avg_frag_length)</span></pre>
                     </div>
                  </div>
                  <div id="background" class="section level2">
                     <h2 class="hasAnchor">
                        <a href="#example" class="anchor"></a>Random Sample GC-matched Background
                     </h2>
                     <p>The following line selects a number of GC matched neighbors for each feature and stores them in a matrix</p>
                     <div class="sourceCode" id="cb2">
                        <pre class="r"><span class ="no">name_table <- getGCBackground(coverage, df, GC_radius, GC_sample_size)</span></pre>
                     </div>
                  </div>
                  <div id="fold_change" class="section level2">
                     <h2 class="hasAnchor">
                        <a href="#example" class="anchor"></a>Calculate CNV Fold Change
                     </h2>
                     <p>This section calculates the the average CNV background for each cell and uses it to calculate fold change</p>
                     <div class="sourceCode" id="cb2">
                        <pre class="r"><span class ="no">avg_table <- calcAvgTable(coverage, name_table)
fc <- coverage / avg_table</span></pre>
                     </div>
                  </div>
                  <div id="gc_cor" class="section level2">
                     <h2 class="hasAnchor">
                        <a href="#example" class="anchor"></a>Create GC Correlation Plot
                     </h2>
                     <p>The following line creates a CNV vs. GC correlation plot</p>
                     <div class="sourceCode" id="cb2">
                        <pre class="r"><span class ="no">GC_Content <- GCplot(fc,df,project,"spearman")</span></pre>
                     </div>
                     <img src="images/GC.png" width="350">
                  </div>
                  <div id="tad_cor" class="section level2">
                     <h2 class="hasAnchor">
                        <a href="#example" class="anchor"></a>Create TAD Correlation Plot
                     </h2>
                     <p>The following line creates a TAD vs. GC correlation plot</p>
                     <div class="sourceCode" id="cb2">
                        <pre class="r"><span class ="no">tad <- TADplot(fc,tiles,df,project,TAD_cluster)</span></pre>
                     </div>
                     <img src="images/TAD.png" width="350">
                  </div>
                  <div id="atac_cor" class="section level2">
                     <h2 class="hasAnchor">
                        <a href="#example" class="anchor"></a>Create ATAC Correlation Plot
                     </h2>
                     <p>The following line creates a ATAC vs. GC correlation plot</p>
                     <div class="sourceCode" id="cb2">
                        <pre class="r"><span class ="no">target_t <- ATACplot(cells,target_fragments, df, fc, project, "spearman")</span></pre>
                     </div>
                     <img src="images/ATAC.png" width="350">
                  </div>
                  <div id="heatmap" class="section level2">
                     <h2 class="hasAnchor">
                        <a href="#example" class="anchor"></a>Create CNV Heatmap
                     </h2>
                     <p>The following line creates a Heatmap of CNV data. Cells are either clustered with k-means</p>
                     <div class="sourceCode" id="cb2">
                        <pre class="r"><span class ="no">output <- plotCNV(fc, k_means, k_means_cell_cut_off, gz, project, GC_Content=GC_Content ,tad=tad, target_t=target_t)</span></pre>
                     </div>
                     <img src="images/heatmap.png" width="625">
                  </div>
               </div>
            </div>
            <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
               <div id="tocnav">
                  <h2 class="hasAnchor">
                     <a href="#tocnav" class="anchor"></a>Contents
                  </h2>
                  <ul class="nav nav-pills nav-stacked">
                     <li><a href="#installation">Installation</a></li>
                     <li><a href="#tiles">Creating Genomic Tiles</a></li>
                     <li><a href="#gc_content">Calculating GC Content for each tile </a></li>
                     <li><a href="#peaks">Calculating Peak Overlap </a></li>
                     <li><a href="#count">Produce a Count Matrix </a></li>
                     <li><a href="#coverage">Calculate Coverage </a></li>
                     <li><a href="#background">Random Sample GC-matched Background </a></li>
                     <li><a href="#fold_change">Calculate CNV Fold Change </a></li>
                     <li><a href="#gc_cor">Create GC Correlation Plot </a></li>
                     <li><a href="#tad_cor">Create TAD Correlation Plot </a></li>
                     <li><a href="#atac_cor">Create ATAC Correlation Plot </a></li>
                     <li><a href="#heatmap">Create CNV Heatmap </a></li>
                  </ul>
               </div>
            </div>
         </div>
         <footer>
            <div class="pkgdown">
               <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
            </div>
         </footer>
      </div>
   </body>
</html>
